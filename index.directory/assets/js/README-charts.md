# Charts.js - Homepage Chart Management

## Overview

`charts.js` handles the rendering and switching of all four chart types on the homepage:
1. **Equity Curve** - Cumulative P&L over time (line chart)
2. **Trade Distribution** - P&L by individual trade (bar chart)
3. **Performance By Day** - Average P&L by day of week (bar chart)
4. **Ticker Performance** - Total P&L by ticker (horizontal bar chart)

## Features

### Chart Selector Dropdown
- Allows users to switch between chart views without page reload
- Shows/hides appropriate chart containers
- Lazy loads charts (only loads when selected)

### Consistent Styling
- All charts use the same color scheme and fonts
- Dark theme with terminal green (#00ff88) for profits and red (#ff4757) for losses
- JetBrains Mono font for consistency with the rest of the site

### Data Loading
- Fetches chart data from JSON files in `/index.directory/assets/charts/`
- Handles missing data gracefully with placeholder messages
- Supports dynamic base path for GitHub Pages deployment

## Data Files

Each chart type requires a corresponding JSON data file:

| Chart Type | Data File | Chart Type |
|-----------|-----------|------------|
| Equity Curve | `equity-curve-data.json` | Line |
| Trade Distribution | `trade-distribution-data.json` | Bar |
| Performance By Day | `performance-by-day-data.json` | Bar |
| Ticker Performance | `ticker-performance-data.json` | Horizontal Bar |

All data files are generated by `.github/scripts/generate_charts.py`

## HTML Structure

The HTML requires:
1. A `<select>` element with id `chart-selector`
2. Four container divs with ids:
   - `equity-curve-container`
   - `trade-distribution-container`
   - `performance-by-day-container`
   - `ticker-performance-container`
3. Four canvas elements with ids:
   - `equity-curve-chart`
   - `trade-distribution-chart`
   - `performance-by-day-chart`
   - `ticker-performance-chart`

## Usage

### Basic Setup
```html
<!-- Chart.js library -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

<!-- Charts management script -->
<script src="index.directory/assets/js/charts.js"></script>
```

The script automatically initializes when the DOM is ready.

### Switching Charts Programmatically
```javascript
// Access the selector
const selector = document.getElementById('chart-selector');

// Change to trade distribution
selector.value = 'trade-distribution';
selector.dispatchEvent(new Event('change'));
```

## Functions

### `getCommonChartOptions()`
Returns a configuration object with common Chart.js options for consistent styling.

### `loadEquityCurveChart()`
Loads and renders the equity curve chart (cumulative P&L line chart).

### `loadTradeDistributionChart()`
Loads and renders the trade distribution chart (P&L bar chart).

### `loadPerformanceByDayChart()`
Loads and renders the performance by day chart (average P&L by day).

### `loadTickerPerformanceChart()`
Loads and renders the ticker performance chart (total P&L by ticker).

### `switchChart(chartType)`
Switches between chart views by showing/hiding containers and loading data if needed.

### `renderEmptyChart(ctx, message)`
Renders a placeholder chart with a message when data is not available.

### `initCharts()`
Initializes the chart system, loads the default chart (equity curve), and sets up event listeners.

## Error Handling

- If a data file is not found (404), an empty chart is displayed with an informative message
- All errors are logged to the console for debugging
- The page continues to function even if individual charts fail to load

## Customization

### Changing Colors
Edit the color values in the data files or modify the `backgroundColor` and `borderColor` in the chart options.

### Adding New Chart Types
1. Add data generation logic to `generate_charts.py`
2. Add new option to the selector dropdown
3. Create container and canvas elements in HTML
4. Add loading function in `charts.js`
5. Update the switch statement in `switchChart()`

### Modifying Chart Appearance
Edit the `getCommonChartOptions()` function to change:
- Grid colors
- Tick formatting
- Legend display
- Tooltip styling
- Font sizes and families

## Dependencies

- **Chart.js 4.4.0+** - JavaScript charting library
- **Browser**: Modern browser with ES6 support

## Related Files

- `.github/scripts/generate_charts.py` - Generates chart data
- `index.directory/assets/charts/README.md` - Chart data documentation
- `index.html` - Homepage using the charts

## Troubleshooting

### Charts not displaying
- Check browser console for errors
- Verify Chart.js library is loaded
- Ensure data files exist in `/index.directory/assets/charts/`

### Charts showing "No data available"
- Run `python .github/scripts/generate_charts.py` to generate data
- Check that `trades-index.json` contains trade data

### Selector not switching charts
- Verify all container divs have correct IDs
- Check that event listener is attached to selector
- Ensure containers have proper CSS for show/hide

---

**Last Updated:** October 2025  
**Maintained By:** SFTi-Pennies Development Team
